# 07-éƒ¨ç½²æŒ‡å—

> è¨€è‘‰AI (Kotoba AI) å®‰è£…ã€é…ç½®ä¸å¯åŠ¨æŒ‡å—

---

## 7.1 ç¯å¢ƒè¦æ±‚

### 7.1.1 ç³»ç»Ÿè¦æ±‚

| é¡¹ç›® | æœ€ä½è¦æ±‚ | æ¨èé…ç½® |
|------|---------|----------|
| æ“ä½œç³»ç»Ÿ | Windows 10 / macOS 10.14 / Linux | Windows 11 / macOS 13 / Ubuntu 22.04 |
| Python | 3.8 | 3.11 |
| å†…å­˜ | 2GB | 4GB |
| ç£ç›˜ç©ºé—´ | 100MB | 500MB |
| æµè§ˆå™¨ | Chrome 90+ / Firefox 90+ / Safari 14+ | æœ€æ–°ç‰ˆ |

### 7.1.2 Pythonä¾èµ–

```
Flask==3.0.0
Werkzeug==3.0.1
click==8.1.7
itsdangerous==2.1.2
Jinja2==3.1.2
MarkupSafe==2.1.3
```

---

## 7.2 å®‰è£…æ­¥éª¤

### 7.2.1 æ–¹å¼ä¸€ï¼šä½¿ç”¨å®‰è£…è„šæœ¬ï¼ˆæ¨èï¼‰

#### macOS / Linux

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd kotoba-ai

# 2. è¿è¡Œå®‰è£…è„šæœ¬
bash install.sh

# 3. å¯åŠ¨åº”ç”¨
python run.py
```

#### Windows

```powershell
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd kotoba-ai

# 2. è¿è¡Œå®‰è£…è„šæœ¬
.\install.bat

# 3. å¯åŠ¨åº”ç”¨
python run.py
```

### 7.2.2 æ–¹å¼äºŒï¼šæ‰‹åŠ¨å®‰è£…

```bash
# 1. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èï¼‰
python -m venv venv

# 2. æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
# macOS/Linux:
source venv/bin/activate
# Windows:
venv\Scripts\activate

# 3. å®‰è£…ä¾èµ–
pip install -r src/backend/requirements.txt

# 4. åˆå§‹åŒ–æ•°æ®åº“
python scripts/init_db.py

# 5. å¯åŠ¨åº”ç”¨
python run.py
```

---

## 7.3 é…ç½®è¯´æ˜

### 7.3.1 é…ç½®æ–‡ä»¶

åˆ›å»º `src/backend/config.py`ï¼š

```python
import os

class Config:
    """åº”ç”¨é…ç½®"""
    
    # æ•°æ®åº“
    DATABASE_PATH = os.path.join(os.path.dirname(os.path.dirname(__file__)), 
                                  '..', 'data', 'japanese_learning.db')
    
    # ä¸Šä¼ æ–‡ä»¶
    UPLOAD_FOLDER = os.path.join(os.path.dirname(os.path.dirname(__file__)), 
                                  '..', 'uploads')
    MAX_CONTENT_LENGTH = 16 * 1024 * 1024  # 16MB
    
    # åº”ç”¨è®¾ç½®
    DEBUG = True
    SECRET_KEY = 'your-secret-key-here'  # ç”Ÿäº§ç¯å¢ƒè¯·ä¿®æ”¹
    
    # åˆ†é¡µè®¾ç½®
    DEFAULT_PAGE_SIZE = 20
    MAX_PAGE_SIZE = 100
    
    # ç»ƒä¹ è®¾ç½®
    DAILY_PRACTICE_COUNT = 20
    
    @staticmethod
    def init_app(app):
        """åˆå§‹åŒ–åº”ç”¨"""
        # ç¡®ä¿ç›®å½•å­˜åœ¨
        os.makedirs(os.path.dirname(Config.DATABASE_PATH), exist_ok=True)
        os.makedirs(Config.UPLOAD_FOLDER, exist_ok=True)
```

### 7.3.2 ç¯å¢ƒå˜é‡

```bash
# å¯é€‰çš„ç¯å¢ƒå˜é‡
export KOTOBA_DEBUG=true              # è°ƒè¯•æ¨¡å¼
export KOTOBA_SECRET_KEY=your-key     # å¯†é’¥
export KOTOBA_PORT=5000               # æœåŠ¡ç«¯å£
export KOTOBA_HOST=127.0.0.1          # ç»‘å®šåœ°å€
```

---

## 7.4 å¯åŠ¨åº”ç”¨

### 7.4.1 å¼€å‘æ¨¡å¼

```bash
# ä½¿ç”¨Flaskå†…ç½®æœåŠ¡å™¨ï¼ˆä»…å¼€å‘ï¼‰
python run.py

# æˆ–
python -m flask run --host=0.0.0.0 --port=5000
```

### 7.4.2 ç”Ÿäº§æ¨¡å¼ï¼ˆé¢„ç•™ï¼‰

```bash
# ä½¿ç”¨Gunicornï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
gunicorn -w 4 -b 127.0.0.1:5000 src.backend.app:app

# ä½¿ç”¨uWSGI
uwsgi --http 127.0.0.1:5000 --wsgi-file src/backend/app.py --callable app
```

---

## 7.5 ç›®å½•ç»“æ„è¯´æ˜

```
kotoba-ai/
â”œâ”€â”€ data/                           # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ japanese_learning.db       # SQLiteæ•°æ®åº“æ–‡ä»¶ â­ä¸è¦åˆ é™¤
â”‚   â””â”€â”€ backups/                   # è‡ªåŠ¨å¤‡ä»½ç›®å½•
â”‚
â”œâ”€â”€ uploads/                        # ä¸Šä¼ æ–‡ä»¶ï¼ˆæˆªå›¾ï¼‰
â”‚   â””â”€â”€ *.png/jpg                  # æ‚¨ä¸Šä¼ çš„æˆªå›¾
â”‚
â”œâ”€â”€ docs/                          # è®¾è®¡æ–‡æ¡£
â”‚   â””â”€â”€ *.md                       # Markdownæ–‡æ¡£
â”‚
â”œâ”€â”€ src/                           # æºä»£ç 
â”‚   â”œâ”€â”€ backend/                   # Flaskåç«¯
â”‚   â”‚   â”œâ”€â”€ app.py                # ä¸»åº”ç”¨
â”‚   â”‚   â”œâ”€â”€ config.py             # é…ç½®
â”‚   â”‚   â”œâ”€â”€ requirements.txt      # Pythonä¾èµ–
â”‚   â”‚   â”œâ”€â”€ models/               # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ routes/               # APIè·¯ç”±
â”‚   â”‚   â”œâ”€â”€ services/             # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â””â”€â”€ utils/                # å·¥å…·å‡½æ•°
â”‚   â”‚
â”‚   â””â”€â”€ frontend/                  # Webå‰ç«¯
â”‚       â”œâ”€â”€ index.html            # é¦–é¡µ
â”‚       â”œâ”€â”€ pages/                # é¡µé¢
â”‚       â””â”€â”€ static/               # é™æ€èµ„æº
â”‚
â”œâ”€â”€ scripts/                       # å·¥å…·è„šæœ¬
â”‚   â”œâ”€â”€ init_db.py                # åˆå§‹åŒ–æ•°æ®åº“
â”‚   â”œâ”€â”€ backup.py                 # å¤‡ä»½è„šæœ¬
â”‚   â””â”€â”€ reset.py                  # é‡ç½®è„šæœ¬
â”‚
â”œâ”€â”€ run.py                         # å¯åŠ¨è„šæœ¬ â­ç”¨è¿™ä¸ªå¯åŠ¨
â”œâ”€â”€ install.sh                     # Mac/Linuxå®‰è£…
â”œâ”€â”€ install.bat                    # Windowså®‰è£…
â””â”€â”€ requirements.txt               # æ ¹ç›®å½•ä¾èµ–
```

---

## 7.6 å¸¸ç”¨æ“ä½œ

### 7.6.1 æ•°æ®åº“å¤‡ä»½

```bash
# æ‰‹åŠ¨å¤‡ä»½
python scripts/backup.py

# æˆ–æ‰‹åŠ¨å¤åˆ¶
cp data/japanese_learning.db backups/japanese_learning_$(date +%Y%m%d).db
```

### 7.6.2 æ•°æ®åº“é‡ç½®

```bash
# è­¦å‘Šï¼šè¿™å°†æ¸…ç©ºæ‰€æœ‰æ•°æ®ï¼
python scripts/reset.py

# æˆ–æ‰‹åŠ¨åˆ é™¤åé‡æ–°åˆå§‹åŒ–
rm data/japanese_learning.db
python scripts/init_db.py
```

### 7.6.3 æŸ¥çœ‹æ—¥å¿—

```bash
# å®æ—¶æŸ¥çœ‹æ—¥å¿—
tail -f logs/app.log

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
tail -f logs/error.log
```

---

## 7.7 æ•…éšœæ’é™¤

### 7.7.1 å¸¸è§é—®é¢˜

#### Q1: ç«¯å£è¢«å ç”¨

```bash
# é”™è¯¯ä¿¡æ¯ï¼šAddress already in use

# è§£å†³ï¼šæ›´æ¢ç«¯å£
python run.py --port=8080

# æˆ–æŸ¥æ‰¾å¹¶å…³é—­å ç”¨ç«¯å£çš„è¿›ç¨‹
# macOS/Linux:
lsof -i :5000
kill -9 <PID>

# Windows:
netstat -ano | findstr :5000
taskkill /PID <PID> /F
```

#### Q2: æ•°æ®åº“æƒé™é”™è¯¯

```bash
# é”™è¯¯ä¿¡æ¯ï¼šunable to open database file

# è§£å†³ï¼šæ£€æŸ¥ç›®å½•æƒé™
chmod 755 data/
chmod 644 data/japanese_learning.db
```

#### Q3: Pythonæ¨¡å—æœªæ‰¾åˆ°

```bash
# é”™è¯¯ä¿¡æ¯ï¼šNo module named 'flask'

# è§£å†³ï¼šé‡æ–°å®‰è£…ä¾èµ–
pip install -r src/backend/requirements.txt

# ç¡®è®¤Pythonç‰ˆæœ¬
python --version  # éœ€è¦3.8+
```

#### Q4: é™æ€æ–‡ä»¶åŠ è½½å¤±è´¥

```bash
# æ£€æŸ¥é™æ€æ–‡ä»¶è·¯å¾„
# ç¡®è®¤ src/frontend/static/ ç›®å½•å­˜åœ¨
ls -la src/frontend/static/
```

### 7.7.2 è°ƒè¯•æ¨¡å¼

```bash
# å¯ç”¨è°ƒè¯•æ¨¡å¼ï¼ˆè¯¦ç»†é”™è¯¯ä¿¡æ¯ï¼‰
export KOTOBA_DEBUG=true
python run.py
```

---

## 7.8 å‡çº§ç»´æŠ¤

### 7.8.1 æ›´æ–°ä»£ç 

```bash
# æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main

# æ›´æ–°ä¾èµ–
pip install -r src/backend/requirements.txt --upgrade

# æ£€æŸ¥æ•°æ®åº“è¿ç§»ï¼ˆå¦‚æœ‰ï¼‰
python scripts/migrate.py
```

### 7.8.2 æ•°æ®åº“è¿ç§»

```bash
# æŸ¥çœ‹å½“å‰ç‰ˆæœ¬
python scripts/db_version.py

# æ‰§è¡Œè¿ç§»
python scripts/migrate.py upgrade
```

---

## 7.9 äº‘ç«¯éƒ¨ç½²é¢„ç•™ï¼ˆæœªæ¥ï¼‰

### 7.9.1 éƒ¨ç½²æ¶æ„

```mermaid
flowchart TB
    subgraph äº‘ç«¯éƒ¨ç½²æ¶æ„
        LB[è´Ÿè½½å‡è¡¡<br/>Nginx] --> W1[WebæœåŠ¡å™¨1<br/>Gunicorn]
        LB --> W2[WebæœåŠ¡å™¨2<br/>Gunicorn]
        
        W1 --> DB[(PostgreSQL)]
        W2 --> DB
        
        W1 --> Cache[(Redis)]
        W2 --> Cache
    end
    
    subgraph å½“å‰æœ¬åœ°æ¶æ„
        L[Flask<br/>å†…ç½®æœåŠ¡å™¨] --> S[(SQLite)]
    end
    
    style äº‘ç«¯éƒ¨ç½²æ¶æ„ fill:#e1f5ff
```

### 7.9.2 è¿ç§»è·¯å¾„

1. **æ•°æ®åº“**: SQLite â†’ PostgreSQLï¼ˆä½¿ç”¨å¯¼å‡º/å¯¼å…¥è„šæœ¬ï¼‰
2. **åç«¯**: Flask â†’ Gunicorn + Nginx
3. **ç¼“å­˜**: æ·»åŠ Redisç¼“å­˜å±‚
4. **å‰ç«¯**: é™æ€æ–‡ä»¶ â†’ CDN
5. **éƒ¨ç½²**: Dockerå®¹å™¨åŒ–

### 7.9.3 Dockeræ”¯æŒï¼ˆé¢„ç•™ï¼‰

```dockerfile
# Dockerfileï¼ˆé¢„ç•™ï¼‰
FROM python:3.11-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install -r requirements.txt

COPY . .

EXPOSE 5000

CMD ["python", "run.py"]
```

```yaml
# docker-compose.ymlï¼ˆé¢„ç•™ï¼‰
version: '3.8'
services:
  app:
    build: .
    ports:
      - "5000:5000"
    volumes:
      - ./data:/app/data
      - ./uploads:/app/uploads
```

---

## 7.10 å®‰å…¨æ£€æŸ¥æ¸…å•

### éƒ¨ç½²å‰æ£€æŸ¥

- [ ] ä¿®æ”¹é»˜è®¤ SECRET_KEY
- [ ] å…³é—­ DEBUG æ¨¡å¼ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
- [ ] é…ç½®æ­£ç¡®çš„æ–‡ä»¶æƒé™
- [ ] å¯ç”¨æ•°æ®åº“å¤‡ä»½
- [ ] æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
- [ ] é…ç½®HTTPSï¼ˆäº‘ç«¯éƒ¨ç½²ï¼‰

### æ—¥å¸¸ç»´æŠ¤

- [ ] å®šæœŸå¤‡ä»½æ•°æ®åº“ï¼ˆå»ºè®®æ¯å¤©ï¼‰
- [ ] æ£€æŸ¥ç£ç›˜ç©ºé—´
- [ ] æŸ¥çœ‹é”™è¯¯æ—¥å¿—
- [ ] æ›´æ–°ä¾èµ–åŒ…ï¼ˆæ¯æœˆï¼‰

---

## 7.11 è”ç³»æ–¹å¼ä¸æ”¯æŒ

### è·å–å¸®åŠ©

- ğŸ“– æŸ¥çœ‹æ–‡æ¡£ï¼š`docs/` ç›®å½•
- ğŸ› æäº¤é—®é¢˜ï¼šGitHub Issues
- ğŸ’¬ åŠŸèƒ½å»ºè®®ï¼šGitHub Discussions

### è´¡çŒ®ä»£ç 

1. Fork é¡¹ç›®
2. åˆ›å»ºåˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»º Pull Request

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¥æœŸ**: 2026-02-11  
**æœ€åæ›´æ–°**: 2026-02-11

---

**æ„Ÿè°¢ä½¿ç”¨ è¨€è‘‰AI (Kotoba AI)ï¼** ğŸŒ¸

ç¥æ‚¨çš„æ—¥è¯­å­¦ä¹ ä¹‹æ—…æ„‰å¿«ï¼
