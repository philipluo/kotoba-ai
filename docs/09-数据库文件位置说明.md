# æ•°æ®åº“æ–‡ä»¶ä½ç½®è¯´æ˜Ž

> è¨€è‘‰AI (Kotoba AI) æ•°æ®åº“æ–‡ä»¶ä½ç½®ä¸Žæ“ä½œæŒ‡å—

---

## ðŸ“ æ•°æ®åº“æ–‡ä»¶ä½ç½®

**å®žé™…æ•°æ®åº“æ–‡ä»¶è·¯å¾„ï¼š**

```
/Users/Philip/study/æ—¥è¯­å­¦ä¹ åŠ©æ‰‹/kotoba-ai/data/japanese_learning.db
```

**ç›¸å¯¹è·¯å¾„ï¼ˆä»Žé¡¹ç›®æ ¹ç›®å½•ï¼‰ï¼š**

```
kotoba-ai/data/japanese_learning.db
```

---

## ðŸ“Š æ–‡ä»¶ä¿¡æ¯

| å±žæ€§ | å€¼ |
|------|-----|
| **æ–‡ä»¶å** | `japanese_learning.db` |
| **æ–‡ä»¶æ ¼å¼** | SQLite 3 |
| **æ–‡ä»¶ç±»åž‹** | å•æ–‡ä»¶æ•°æ®åº“ |
| **é»˜è®¤ä½ç½®** | `é¡¹ç›®æ ¹ç›®å½•/data/japanese_learning.db` |
| **å¤‡ä»½ç›®å½•** | `é¡¹ç›®æ ¹ç›®å½•/data/backups/` |

---

## ðŸ—„ï¸ æ•°æ®åº“åŒ…å«çš„å†…å®¹

### 1. æ ¸å¿ƒæ•°æ®è¡¨ï¼ˆ5å¼ ï¼‰

| è¡¨å | è¯´æ˜Ž |
|------|------|
| `raw_entries` | åŽŸå§‹å­¦ä¹ è®°å½•ï¼ˆå¥å­/å•è¯/çŸ­è¯­ï¼‰ |
| `segmented_words` | è‡ªåŠ¨åˆ†è¯ç»“æžœ |
| `verb_master` | åŠ¨è¯åŽŸåž‹åº“ |
| `verb_conjugations` | åŠ¨è¯12ç§æ´»ç”¨å½¢å¼ |
| `phonetic_index` | 50éŸ³æ£€ç´¢ç´¢å¼• |

### 2. åŸºç¡€æ•°æ®è¡¨

| è¡¨å | è¯´æ˜Ž |
|------|------|
| `phonetics` | 50éŸ³å›¾è¡¨æ•°æ®ï¼ˆæ¸…éŸ³/æµŠéŸ³/åŠæµŠéŸ³ï¼‰ |
| `daily_practice` | æ¯æ—¥ç»ƒä¹ è®°å½• |

---

## ðŸ’¾ å¸¸ç”¨æ“ä½œ

### 1. å¤‡ä»½æ•°æ®åº“

**æ‰‹åŠ¨å¤‡ä»½ï¼š**
```bash
# å¤åˆ¶æ•°æ®åº“æ–‡ä»¶åˆ°å¤‡ä»½ç›®å½•
cp kotoba-ai/data/japanese_learning.db \
   kotoba-ai/data/backups/japanese_learning_$(date +%Y%m%d).db
```

**ä½¿ç”¨è„šæœ¬å¤‡ä»½ï¼š**
```bash
cd kotoba-ai
python3 scripts/backup.py
```

### 2. æŸ¥çœ‹æ•°æ®åº“å†…å®¹

**æŸ¥çœ‹æ‰€æœ‰è¡¨ï¼š**
```bash
sqlite3 kotoba-ai/data/japanese_learning.db ".tables"
```

**æŸ¥çœ‹å­¦ä¹ è®°å½•ï¼š**
```bash
sqlite3 kotoba-ai/data/japanese_learning.db \
  "SELECT id, original_jp, chinese_meaning, created_at FROM raw_entries;"
```

**æŸ¥çœ‹ç»Ÿè®¡ï¼š**
```bash
sqlite3 kotoba-ai/data/japanese_learning.db \
  "SELECT COUNT(*) as total_entries FROM raw_entries;"
```

**æŸ¥çœ‹åˆ†è¯æ•°æ®ï¼š**
```bash
sqlite3 kotoba-ai/data/japanese_learning.db \
  "SELECT word_jp, word_type, hiragana FROM segmented_words LIMIT 10;"
```

### 3. é‡ç½®æ•°æ®åº“

**åˆ é™¤å¹¶é‡æ–°åˆå§‹åŒ–ï¼š**
```bash
cd kotoba-ai
rm data/japanese_learning.db
python3 scripts/init_db.py
```

**æˆ–ä½¿ç”¨é‡ç½®è„šæœ¬ï¼š**
```bash
cd kotoba-ai
python3 scripts/reset.py
```

---

## ðŸ”§ æ•°æ®åº“é…ç½®

### é…ç½®æ–‡ä»¶ä½ç½®

`kotoba-ai/src/backend/config.py`

```python
DATABASE_PATH = os.path.join(BASE_DIR, 'data', 'japanese_learning.db')
```

### çŽ¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰

```bash
# ä¿®æ”¹æ•°æ®åº“è·¯å¾„ï¼ˆä¸å»ºè®®ï¼‰
export KOTOBA_DB_PATH=/custom/path/to/database.db
```

---

## ðŸ“‹ æ•°æ®å¤‡ä»½ç­–ç•¥å»ºè®®

### è‡ªåŠ¨å¤‡ä»½ï¼ˆæŽ¨èï¼‰

**è®¾ç½®å®šæ—¶ä»»åŠ¡ï¼ˆcrontabï¼‰ï¼š**
```bash
# æ¯å¤©å‡Œæ™¨2ç‚¹è‡ªåŠ¨å¤‡ä»½
0 2 * * * cd /Users/Philip/study/æ—¥è¯­å­¦ä¹ åŠ©æ‰‹/kotoba-ai && python3 scripts/backup.py
```

### æ‰‹åŠ¨å¤‡ä»½æ—¶æœº

- âœ… æ¯æ¬¡å¤§é‡å½•å…¥å‰
- âœ… æ¯å‘¨å›ºå®šæ—¶é—´
- âœ… ç³»ç»Ÿå‡çº§å‰
- âœ… é‡è¦å­¦ä¹ é‡Œç¨‹ç¢‘åŽ

---

## ðŸš¨ æ³¨æ„äº‹é¡¹

1. **ä¸è¦ç›´æŽ¥ç¼–è¾‘æ•°æ®åº“æ–‡ä»¶** - ä½¿ç”¨ç³»ç»ŸAPIæˆ–ç®¡ç†å·¥å…·
2. **å®šæœŸå¤‡ä»½** - SQLiteè™½ç¨³å®šï¼Œä½†ä»å»ºè®®å¤‡ä»½
3. **å•æ–‡ä»¶ä¼˜åŠ¿** - å¤‡ä»½åªéœ€å¤åˆ¶ä¸€ä¸ªæ–‡ä»¶
4. **è·¨å¹³å°** - å¯åœ¨ä»»ä½•æ”¯æŒSQLiteçš„ç³»ç»Ÿä¸­æ‰“å¼€
5. **å®¹é‡é™åˆ¶** - SQLiteæ”¯æŒTBçº§æ•°æ®ï¼Œä¸ªäººå­¦ä¹ å®Œå…¨å¤Ÿç”¨

---

## ðŸ” æ•…éšœæŽ’æŸ¥

### é—®é¢˜1ï¼šæ‰¾ä¸åˆ°æ•°æ®åº“æ–‡ä»¶

```bash
# æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls -la kotoba-ai/data/japanese_learning.db

# å¦‚æžœä¸å­˜åœ¨ï¼Œé‡æ–°åˆå§‹åŒ–
python3 scripts/init_db.py
```

### é—®é¢˜2ï¼šæ•°æ®åº“æŸå

```bash
# å°è¯•ä¿®å¤
sqlite3 kotoba-ai/data/japanese_learning.db ".recover" > recovery.sql
sqlite3 new_database.db < recovery.sql
```

### é—®é¢˜3ï¼šæƒé™é”™è¯¯

```bash
# ä¿®å¤æƒé™
chmod 644 kotoba-ai/data/japanese_learning.db
chmod 755 kotoba-ai/data/
```

---

## ðŸ“ž æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°æ•°æ®åº“ç›¸å…³é—®é¢˜ï¼Œå¯ï¼š
1. æŸ¥çœ‹å¤‡ä»½æ–‡ä»¶æ¢å¤æ•°æ®
2. é‡æ–°åˆå§‹åŒ–æ•°æ®åº“ï¼ˆä¼šæ¸…ç©ºæ•°æ®ï¼‰
3. ä½¿ç”¨SQLiteæµè§ˆå™¨å·¥å…·å¯è§†åŒ–æŸ¥çœ‹

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¥æœŸ**: 2026-02-11  
**æœ€åŽæ›´æ–°**: 2026-02-11
